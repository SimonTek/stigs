#!/bin/bash
#Created by Matthew M. Conley / SimonTek

#Group ID: V-38519
#Group Title: SRG-OS-000206
#Version: RHEL-06-000134
#Severity: medium
#Description: The log files generated by rsyslog contain valuable information regarding system configuration, user authentication, and other such information. Log files should be protected from unauthorized access.
#Rule Title: All rsyslog-generated log files must be group-owned by root.
#Version: RHEL-06-000134

#Check Content: The group-owner of all log files written by "rsyslog" should be root. These log files are determined by the second part of each Rule line in "/etc/rsyslog.conf" and typically all appear in "/var/log". For each log file [LOGFILE] referenced in "/etc/rsyslog.conf", run the following command to inspect the file's group owner: 

#$ ls -l [LOGFILE]

#If the group-owner is not root, this is a finding.


#Fix Text: The group-owner of all log files written by "rsyslog" should be root. These log files are determined by the second part of each Rule line in "/etc/rsyslog.conf" and typically all appear in "/var/log". For each log file [LOGFILE] referenced in "/etc/rsyslog.conf", run the following command to inspect the file's group owner:

#$ ls -l [LOGFILE]

#If the owner is not "root", run the following command to correct this:

# chgrp root [LOGFILE]

if ls -l /var/log/messages|grep " root "; then
echo "This machine is RHEL-06-000134 Compliant" >> /var/log/Stig
echo "This machine is RHEL-06-000134 Compliant"
else
echo "This machine isn't RHEL-06-000134 Compliant" >> /var/log/Stig
echo "This machine isn't RHEL-06-000134 Compliant"
chgrp root /var/log/messages
fi

if ls -l /var/log/secure|grep " root "; then
echo "This machine is RHEL-06-000134 Compliant" >> /var/log/Stig
echo "This machine is RHEL-06-000134 Compliant"
else
echo "This machine isn't RHEL-06-000134 Compliant" >> /var/log/Stig
echo "This machine isn't RHEL-06-000134 Compliant"
chgrp root /var/log/secure
fi

if ls -l /var/log/maillog|grep " root "; then
echo "This machine is RHEL-06-000134 Compliant" >> /var/log/Stig
echo "This machine is RHEL-06-000134 Compliant"
else
echo "This machine isn't RHEL-06-000134 Compliant" >> /var/log/Stig
echo "This machine isn't RHEL-06-000134 Compliant"
chgrp root /var/log/maillog
fi

if ls -l /var/log/cron|grep " root "; then
echo "This machine is RHEL-06-000134 Compliant" >> /var/log/Stig
echo "This machine is RHEL-06-000134 Compliant"
else
echo "This machine isn't RHEL-06-000134 Compliant" >> /var/log/Stig
echo "This machine isn't RHEL-06-000134 Compliant"
chgrp root /var/log/cron
fi

if ls -l /var/log/spooler|grep " root "; then
echo "This machine is RHEL-06-000134 Compliant" >> /var/log/Stig
echo "This machine is RHEL-06-000134 Compliant"
else
echo "This machine isn't RHEL-06-000134 Compliant" >> /var/log/Stig
echo "This machine isn't RHEL-06-000134 Compliant"
chgrp root /var/log/spooler
fi
if ls -l /var/log/boot.log|grep " root "; then
echo "This machine is RHEL-06-000134 Compliant" >> /var/log/Stig
echo "This machine is RHEL-06-000134 Compliant"
else
echo "This machine isn't RHEL-06-000134 Compliant" >> /var/log/Stig
echo "This machine isn't RHEL-06-000134 Compliant"
chgrp root /var/log/boot.log
fi